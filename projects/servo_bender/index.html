<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Electronic String Bender Guitar | Dean  Miller</title>
    <meta name="author" content="Dean  Miller">
    <meta name="description" content="wireless string bender powered by 4 brushless servos">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Bootstrap Table -->
    <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://alshedivat.github.io/projects/servo_bender/">

    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Dean </span>Miller</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      
        <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">Electronic String Bender Guitar</h1>
            <p class="post-description">wireless string bender powered by 4 brushless servos</p>
          </header>

          <article>
            <h4 id="2022">2022</h4>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/bender_cover.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>

<p>Electric guitar players have been using ‘pull-string’ or ‘B-bender’ devices to mimick the sound of a pedal steel guitar for decades. These devices are usually manually actuated using the palm of your hand or by pulling on the guitar strap. This can be difficult to do while playing, and due to the design of these devices they are mostly only used on one of the six guitar strings. The pedal steel guitars the players are trying to imitate have multiple pedals to change the tuning of multiple strings individually, and the pedal steel player can use their feet to work the pedals. I wanted to create a string bender guitar that could use pedals on the floor to electronically change the tuning on the fly.</p>

<p>The criteria for this design were:</p>
<ul>
  <li>be compact enough to fit onto the body of an electric guitar without feeling bulky</li>
  <li>be wirelessly operated using foot pedals</li>
  <li>be able to individually change tuning of 4 separate strings</li>
  <li>be able to change the tuning quickly and quietly so as not to interrupt the music</li>
  <li>be battery powered</li>
</ul>

<p>Here are some video demos of the design in action. If you’re unsure what exactly it’s doing try paying attention to the pitch changes of the notes at the times when the pedals are pressed or released.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <iframe width="100%" height="480" src="https://www.youtube.com/embed/OuNCbN86QOk" title="Electronic string bender guitar demo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe>
    </div>
</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <iframe width="100%" height="480" src="https://www.youtube.com/embed/Mp2r41Q7cyQ" title="Lulu swing (servo motor bender guitar demo)" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe>
    </div>
</div>

<p>A device like this would be impractical to produce as a commercial product and it is not intended as such. However, I like the way it sounds and there are a number of qualities about it that attracted me to it as an interesting and challenging engineering project. I’ll explain the design and where the challenges stem from.</p>

<h2 id="choice-of-motors">Choice of Motors</h2>

<p>The first and perhaps most important part of the design is to determine the proper type of motor to use. Accurate position control is a requirement, so the most obvious answer might seem to be the type of hobby servo motors that are cheap and widely used in RC vehicles. However, these servos are typically heavily geared down DC motors that only travel in a &lt;360 degree arc. The gearing creates lots of audible acoustic noise which is a major issue in a musical instrument. The constrained arc of travel also made it difficult to come up with an elegant mechanical design.</p>

<p>Another option would be small stepper motors. These don’t necessarily require positional feedback, but tend to be quite large in order to get the needed torque for this application without having to gear down. Some initial tests were performed using the tuning machines from an old Gibson robot tuner assembly which use stepper motors but they were far too loud and slow to work for this application.</p>

<p>I chose instead to opt for 3 phase brushless DC motors that are commonly used in quadcopter drones. These motors have the advantage that they have a very high torque-to-weight ratio in a very small package. When the right control scheme (Field Oriented Control) is used, they can be very quiet and move much faster than the hobby servos mentioned above. However, these advantages come with greatly increased complexity in terms of control scheme and needed electronics to drive the motor. This will be discussed in more detail later.</p>

<p>These drone motors are not designed for position control in any way. Due to the strong permanent magnets used they can feel very ‘coggy’ when they are turned. What this means is the rotor wants to ‘snap’ to certain spots when no current is running through the coils. This creates headaches for accurate position control, but can be worked with if there is enough static friction to keep the rotor in place.</p>

<p>To get the required positional feedback from the motors an encoder assembly needed to be created. The motors were modified with a diametric magnet on the back that would sit above a magnetic encoder IC.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/chief-2207-2050kv-motors-v2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/servo_exploded.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    Left: example of a BLDC drone motor. Right: exploded servo assembly.
</div>

<h2 id="mechanical-design">Mechanical Design</h2>

<p>I opted to use the threads for the prop on the drone motors as a sort of lead screw. This helped to make the design less complex and avoid having to use gears. Additionally, the lead screw design allows for the motors to require zero holding torque since all of the force is on the face of the threads. This greatly reduces noise and allows for long battery life since the motors and drivers can be shut down once the desired tuning is reached. Each string bender servo actuates a lever which rotates around a hardened steel axle. The end of the guitar string is anchored around the lever, and this serves to increase or decrease the tension of the string. The top of the lever attaches to an extension spring which is adjusted to counterbalance the tension of the guitar string. This helps to reduce the load on the motors as well as reduce binding in the mechanical parts.</p>

<p>The Lever assembly was designed around off-the-shelf hardware where possible and was 3D printed out of steel.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/lever_exploded.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    exploded render of lever assembly
</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/bender3.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    render of lever assembly and counterbalance spring
</div>

<p>The chassis to house the mechanical components was 3D printed out of a nylon material that is infused with glass beads for added stiffness.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/Screenshot%20(155).png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/Screenshot%20(156).png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    renders of mechanical components housed in chassis.
</div>

<p>This entire mechanical assembly was installed into a routed out guitar body as is shown in the image at the top of the page. An off-the-shelf guitar bridge with rolling string saddles to reduce friction was modified to allow the strings that would be bent to exit through the rear of the bridge, and teflon tubing was added to prevent string breakage due to rubbing.</p>

<p>The pedal assembly was designed around 4 modified piano sustain pedals. A magnet and a linear Hall effect sensor were added to each pedal to produce a continuous voltage signal corresponding to how far down the player is pressing the pedal. The enclosure for the pedals was fabricated out of bent sheet metal.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/IMG_9131.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/IMG_9181.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    Left: render of pedal assembly. Right: completed pedal assembly.
</div>

<h2 id="electrical-design">Electrical Design</h2>

<p>Each servo requires 3 Half-H-Bridges. A three-phase BLDC gate driver IC was used to drive the H-Bridges. The H-Bridges, gate driver, and current sense resistors for each motor were placed on a separate PCB that can be easily replaced since these parts are the most sensitive to getting smoked when anything goes wrong.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/powerStage.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    power stage PCB
</div>

<p>As mentioned earlier, driving the motors quietly and efficiently while being able to get maximum torque out of them requires a somewhat complicated control scheme called Field-Oriented Control (FOC) as opposed to the typical open-loop drive ESC drive that is used for drones. FOC can be difficult to get right and requires precise timing and alignment of the PWM signals into the gate drivers and the ADC readings for the motor phase currents. Thankfully, Trinamic offers an IC that does FOC very well. This IC (the TMC4671) is a bit expensive, but since this is a personal project and we are not being super cost-conscious it fits the bill. Tuning all the different FOC parameters in order to make everything work still requires quite a bit of know how, but all together it’s a lot easier than trying to roll your own.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/TMC4671.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    simplified block diagram of the TMC4671
</div>

<p>Since the TMC4671 is doing most of the heavy lifting for the motor control only a basic STM32 ARM Cortex M0+ microcontroller is needed to run the rest of the firmware tasks. For wireless communication with the pedal assembly, NRF24L01+ radio modules are used. These radio modules are cheap and simple with plenty of existing documentation. All of the rest of this circuitry goes on another PCB. The guitar circuitry is powered by a 3S Lipo battery. It’s important to have a sufficiently low impedance path directly from the battery to each motor power stage as theses motors can draw many amps of current. Without this low impedance path, voltage drops that occur when a motor suddenly turns on will wreak havoc on noise-sensitive components in the circuit like the radio module.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/quadServo.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/IMG_1733.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    testing the electricals wired up to the mechanical assembly (missing back cover on the chassis)
</div>

<h2 id="noise-considerations">Noise Considerations</h2>

<p>One of the challenging aspects of this project is the elimination of electromagnetic interference in the guitar signal. Guitar pickups are very sensitive to noise and interference of exactly the type that electric motors create. For an idea of what this noise sounds like, take a look on youtube for the videos of Eddie Van Halen using an electric drill above his guitar pickups on “Poundcake”. It’s a neat effect, but awful if you’re still trying to play the guitar. To keep as much of this noise as possible out of the pickups, the best things to do are:</p>
<ul>
  <li>place the motors as far from the pickups as possible</li>
  <li>reduce the load on the motors as much as possible with mechanical counterbalancing. More current through the motors creates a stronger magnetic field</li>
  <li>use a MuMETAL shield around the motors</li>
</ul>

<h2 id="conclusion">Conclusion</h2>

<p>The ability to bend four of your guitar strings and to quickly and seamlessly change tunings with foot pedals makes it possible for this device to achieve sounds you can’t really get from any other instrument. I look forward to facing the challenge of becoming more proficient at playing it in the future, and to further improving on the design.</p>

          </article>

        </div>

      
    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2023 Dean  Miller. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script>

  <!-- Bootstrap Table -->
  <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script>

  <!-- Load Common JS -->
  <script src="/assets/js/no_defer.js"></script>
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
